target0 = [ 
    -1 -1 -1 -1 -1 -1 -1 -1 -1 -1;
    -1 -1 -1 1 1 1 1 -1 -1 -1;
    -1 -1 1 1 1 1 1 1 -1 -1;
    -1 1 1 -1 -1 -1 -1 1 1 -1;
    -1 1 1 -1 -1 -1 -1 1 1 -1;
    -1 1 1 -1 -1 -1 -1 1 1 -1;
    -1 1 1 -1 -1 -1 -1 1 1 -1;
    -1 1 1 -1 -1 -1 -1 1 1 -1;
    -1 1 1 -1 -1 -1 -1 1 1 -1;
    -1 -1 1 1 1 1 1 1 -1 -1;
    -1 -1 -1 1 1 1 1 -1 -1 -1;
    -1 -1 -1 -1 -1 -1 -1 -1 -1 -1;
    ];

target2 = [ 
    1 1 1 1 1 1 1 1 -1 -1;
    1 1 1 1 1 1 1 1 -1 -1;
    -1 -1 -1 -1 -1 -1 1 1 -1 -1;
    -1 -1 -1 -1 -1 -1 1 1 -1 -1;
    -1 -1 -1 -1 -1 -1 1 1 -1 -1;
    1 1 1 1 1 1 1 1 -1 -1;  
    1 1 1 1 1 1 1 1 -1 -1;
    1 1 -1 -1 -1 -1 -1 -1 -1 -1;
    1 1 -1 -1 -1 -1 -1 -1 -1 -1;
    1 1 -1 -1 -1 -1 -1 -1 -1 -1;
    1 1 1 1 1 1 1 1 -1 -1;
    1 1 1 1 1 1 1 1 -1 -1;
    ];

target3 = [ 
    -1 -1 1 1 1 1 1 1 -1 -1;
    -1 -1 1 1 1 1 1 1 1 -1;
    -1 -1 -1 -1 -1 -1 -1 1 1 -1;
    -1 -1 -1 -1 -1 -1 -1 1 1 -1;
    -1 -1 -1 -1 -1 -1 -1 1 1 -1;
    -1 -1 -1 -1 1 1 1 1 -1 -1;
    -1 -1 -1 -1 1 1 1 1 -1 -1;
    -1 -1 -1 -1 -1 -1 -1 1 1 -1;
    -1 -1 -1 -1 -1 -1 -1 1 1 -1;
    -1 -1 -1 -1 -1 -1 -1 1 1 -1;
    -1 -1 1 1 1 1 1 1 1 -1;
    -1 -1 1 1 1 1 1 1 -1 -1;
    ];

target6 = [ 
     1  1  1  1  1  1 -1 -1 -1 -1;
     1  1  1  1  1  1 -1 -1 -1 -1;
     1  1 -1 -1 -1 -1 -1 -1 -1 -1;
     1  1 -1 -1 -1 -1 -1 -1 -1 -1;
     1  1 -1 -1 -1 -1 -1 -1 -1 -1;
     1  1  1  1  1  1 -1 -1 -1 -1;
     1  1  1  1  1  1 -1 -1 -1 -1;
     1  1 -1 -1  1  1 -1 -1 -1 -1;
     1  1 -1 -1  1  1 -1 -1 -1 -1;
     1  1 -1 -1  1  1 -1 -1 -1 -1;
     1  1  1  1  1  1 -1 -1 -1 -1;
     1  1  1  1  1  1 -1 -1 -1 -1;
    ];

T = [target6(:), target2(:), target3(:)];
Q = 3;
R = 120;
eps = 1/(Q);

% fisrt layer init thing
fnet = newlin(T,3);
fnet.IW = {[target6(:)'; target2(:)'; target3(:)']};
fnet.b = {repmat(R,3,1)};

sm = sim(fnet, T);

% second layer init
net = newhop(sm);
net.layers{1}.transferFcn = 'poslin';

LW = eye(3);
LW = LW(:);
LW(LW == 0) = -eps;
LW = reshape(LW,3,3);
net.LW = {LW};
net.B = {repmat(R,3,1)};

noised6 = noise(target6(:), 24);
noised3 = noise(target3(:), 36);


temp1 = sim(fnet,noised6);
temp2 = sim(fnet,noised3);

% res = sim(net, 3, [], sm);
res1 = sim(net,1,[],temp1);
res2 = sim(net,1,[],temp2);

[~,j1] = max(res1);
[~,j2] = max(res2);
